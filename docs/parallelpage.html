<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Parallel computation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="rack.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="rack-logo-110x55.png"/></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Parallel computation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section note"><dt>Note</dt><dd>Future extension - not fully implemented yet</dd></dl>
<h1><a class="anchor" id="parallel_intro"></a>
Speed-up through parallel computation</h1>
<p>In processing radar data, some computations can be run independently in separate threads. In <b>Rack</b>, parallel computation can be enabled flexibly on command line. Parallel computing is enabled for a sequence of commands put inside braces: <code></code>[...] . Within braces, only the commands that will trigger a script - especially <code>&ndash;inputFile</code> &ndash; will actually start a thread. In each thread, the command is run, followed by commands in a script, if defined. A schematic decomposition of such a command line is shown in the image below, marking thread-triggering commands <code>cmd</code> and other commands <code>CMD</code>. </p><div class="dotgraph">
<img src="dot_inline_dotgraph_7.png" alt="dot_inline_dotgraph_7.png" border="0" usemap="#dot_inline_dotgraph_7.map"/>
<map name="dot_inline_dotgraph_7.map" id="dot_inline_dotgraph_7.map"><area shape="rect" id="node2" href="" title="Script definition |&lt;i&gt; &#45;&#45;sript &#39;&#45;&#45;cmd &#45;&#45;cmd...&#39; [ " alt="" coords="199,19,341,71"/>
<area shape="rect" id="node3" href="productspage.html" title="Basic commands (CMD...) and \n script triggering commands (cmd..) |&lt;i&gt;[ &#45;&#45;cmd1 &#45;&#45;CMD2 &#45;&#45;cmd3 &#45;&#45;cmd4 &#45;CMD5 ... ] " alt="" coords="389,5,652,72"/>
</map>
</div>
<p>During execution, <b>Rack</b> creates and maintains certain resources in memory for commands to read and write: a polar volume, a polar product, Cartesian product and compositing arrays. (See the scheme in <a class="el" href="index.html#intro">Introduction</a> .) A thread has private resources &ndash; its so called  context &ndash; in addition to shared resources called a  base  context. As a principle in threads, any data loaded or created in the thread overrides the respective data loaded in the main thread. Especially, a composite (accumulation array) initialized in the main thread will serve the threads as a shared resource unless a new composite is initialized or loaded in the thread. Commands use internal logic in selecting</p>
<div class="dotgraph">
<img src="dot_inline_dotgraph_8.png" alt="dot_inline_dotgraph_8.png" border="0" usemap="#dot_inline_dotgraph_8.map"/>
<map name="dot_inline_dotgraph_8.map" id="dot_inline_dotgraph_8.map"><area shape="rect" id="node6" href="" title="{&lt;i&gt;&#45;&#45;cmd1|&lt;s&gt; &#45;&#45;cmd &#45;&#45;cmd ...}" alt="" coords="636,83,795,132"/>
<area shape="rect" id="node7" href="" title="{&lt;i&gt;&#45;&#45;cmd3|&lt;s&gt; &#45;&#45;cmd &#45;&#45;cmd ...}" alt="" coords="636,156,795,205"/>
<area shape="rect" id="node8" href="" title="{&lt;i&gt;&#45;&#45;cmd4|&lt;s&gt; &#45;&#45;cmd &#45;&#45;cmd ...}" alt="" coords="636,229,795,279"/>
</map>
</div>
<h2><a class="anchor" id="parallel_anom"></a>
Parallel anomaly detection</h2>
<div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 [ --aBird <span class="stringliteral">&#39;&#39;</span> --aSpeckle <span class="stringliteral">&#39;&#39;</span> ] --aRemover 0.5 -o vol-anom-paral.h5</div></div><!-- fragment --><h2><a class="anchor" id="parallel_products"></a>
Generating products for each</h2>
<div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --append dataset [ --pCappi 500 --pEchoTop 20dBZ ] -o vol-prod-paral.h5</div></div><!-- fragment --><h2><a class="anchor" id="parallel_anom_products"></a>
Anomaly detection and product generation combined</h2>
<div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 [ --aBird <span class="stringliteral">&#39;&#39;</span> --aSpeckle <span class="stringliteral">&#39;&#39;</span> ] --aRemover 0.5 --append dataset [ --pCappi 500 --pEchoTop 20dBZ ] -o vol-anom-prod-paral.h5</div></div><!-- fragment --><h2><a class="anchor" id="parallel_acc"></a>
Accumulation</h2>
<p>For accumulating polar data, Rack uses a shared accumulation array.</p>
<div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a>  --script <span class="stringliteral">&#39;--pAdd&#39;</span> [ data-acc/2017*.h5 ] --encoding C --pExtract <span class="stringliteral">&#39;dw&#39;</span> -o accumulated-parallel.h5</div></div><!-- fragment --><p>However, parallel computing does not provide much advantage in direct accumulation, where the computing task is simple and hence, file read is the major slowing factor.</p>
<h2><a class="anchor" id="parallel_sites"></a>
Product generation for each site</h2>
<p>By default, the resulting meteorological product is kept in the local context, unless <code>&ndash;append</code> data was used.</p>
<div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> --script <span class="stringliteral">&#39;--pCappi 500 -o cappi-${NOD}.h5 --pEchoTop 20 -o echoTop-${NOD}.h5&#39;</span> [ data/pvol_fi*.h5 ]</div></div><!-- fragment --><h2><a class="anchor" id="parallel_compositing"></a>
Parallel compositing</h2>
<div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a>   --cMethod WAVG,2,3,-32  --cProj <span class="stringliteral">&#39;+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs&#39;</span> \</div><div class="line">       --cSize 2000,2000 --cBBox 0,47,40,73    --cInit    --script <span class="stringliteral">&#39;--pCappi 1500 --cAdd&#39;</span> \</div><div class="line">        [  data-20140924/201409241200_radar.raw.*.h5 ] \</div><div class="line">         --cExtract d  -o composite-parallel.h5</div></div><!-- fragment --><p>See also <a class="el" href="compositespage.html#tiledcompositing">Tiled compositing</a> . </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
