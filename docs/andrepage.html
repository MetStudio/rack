<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Anomaly Detection and Removal (AnDRe)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="rack.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="rack-logo-110x55.png"/></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Sections</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Anomaly Detection and Removal (AnDRe) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Detects birds and insects.</p>
<h1><a class="anchor" id="andreintro"></a>
Introduction</h1>
<p>This section explains <b>AnDRe</b>, the set of anomaly detection and removal functions of <b>Rack</b>. A quick reference of all the commands is found in <a class="el" href="quickpage.html#commands_andre">Anomaly detection and removal commands</a>.</p>
<h2><a class="anchor" id="anomalies"></a>
Background</h2>
<p>Practically, echoes received by a weather radar originate not only from precipitating clouds but also from insects, birds, aircraft, ships, ground, sea clutter and electromagnetic emitters illustrated in the figure below.</p>
<div class="image">
<img src="radar-anomalies-compact2.png" alt="radar-anomalies-compact2.png"/>
<div class="caption">
Sources of anomalies.</div></div>
 <p>These external factors &ndash; or anomalies from the meteorological point of view &ndash; affect radar data in various ways. Some of the anomalies appear as distinct, localized peaks, some form geometrical patterns and some affect the overall data. Examples of effects are shown in the image set below.</p>
<div class="image">
<img src="volumes-anom-panel.png" alt="volumes-anom-panel.png"/>
<div class="caption">
Samples containing several types of anomaly.</div></div>
 <h2><a class="anchor" id="andrecommands"></a>
AnDRe commands</h2>
<p>In AnDRe, the processing is divided into two stages: <b>detecting</b> anomalies and <b>removing</b> the anomalies from input data. In principle, these stages modify ODIM data independently so a user may combine <b>Rack</b> with other software performing anomaly detection or removal. For details in using file input, see <a class="el" href="fileiopage.html#file_quality">Reading and combining quality data</a>.</p>
<p>The following code is an example of applying both detection and removal in <b>Rack</b> :</p>
<div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select <span class="stringliteral">&#39;elangleMax=1.5&#39;</span> \</div><div class="line">  --aEmitter <span class="stringliteral">&#39;5,5,0.5&#39;</span> \</div><div class="line">  --aJamming <span class="stringliteral">&#39;5,80,2,-1&#39;</span> \</div><div class="line">  --aShip    <span class="stringliteral">&#39;25,15,1500,3&#39;</span> \</div><div class="line">  --aSpeckle <span class="stringliteral">&#39;0,9&#39;</span> \</div><div class="line">  --aGapFill <span class="stringliteral">&#39;1500,5&#39;</span> \</div><div class="line">  --aRemover <span class="stringliteral">&#39;0.5&#39;</span> \</div><div class="line">-o volume-corrected.h5    </div></div><!-- fragment --><p>By default, AnDRe commands apply to the full volume input. Each operator will look for quantities (typically DBZH) it needs as input. To decrease computation time, the processing can be limited using <code>&ndash;select</code> command, for example: </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume-anomalous.h5 --select <span class="stringliteral">&#39;/dataset1/data[0-9]+$&#39;</span> &lt;andre-cmds&gt; ...</div></div><!-- fragment --><p> For details, see <a class="el" href="index.html#selecting">Selecting data</a> .</p>
<p>The design of <b>AnDRe</b> detectors is based on <b>Ropo</b> , the operational anomaly detection C program applied in FMI since 2001. Each detector has been fully rewritten as a respective C++ class (rack::BioMetOp, <a class="el" href="classrack_1_1EmitterOp.html" title="A quick emitter detection based on subtracting horizontal window medians by vertical ones...">rack::EmitterOp</a>, <a class="el" href="classrack_1_1ShipOp.html" title="Detects ships. ">rack::ShipOp</a>, <a class="el" href="classrack_1_1SpeckleOp.html">rack::SpeckleOp</a>) which internally applies functions of the <b>Drain</b> library, for example segment size analysis, moving window filters and statistics. In development, emphasis has been on code re-usability, speed and stability; see implementation details further below.</p>
<p><b>Rack</b> provides several detectors that compute detection fields ie. probablity images, explained next. The removal procedures are explained after that.</p>
<h1><a class="anchor" id="detectors"></a>
Detection</h1>
<p>Currently, <b>AnDRe</b> supports detection the following anomalies:</p>
<ol type="1">
<li>birds and insects ("biometeors")</li>
<li>emitter lines</li>
<li>wide spread electromagnetic interference</li>
<li>ships</li>
<li>speckle noise</li>
</ol>
<p>Anomaly detection commands of <b>AnDRe</b> start with <code>'&ndash;a'</code>. The commands can be listed with </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> --help andre </div></div><!-- fragment --><h2><a class="anchor" id="aBiomet"></a>
Detecting birds and insects (single-pol)</h2>
<p>The idea behind bird and insect detector hence "biometeor" detector is very simple. It looks for intensities lower than threshold <code>reflMax</code> and altitudes lower than <code>altitudeMax</code> (metres). The thresholds have fuzzy steepness parameters: intensity steepness <code>reflDev</code> and altitude steepness <code>altitudeDev</code>. The steepness parameters determine "half-widths" of the fuzzy responses (<a class="el" href="detailspage.html#fuzzy">Fuzzy functions</a> ).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">reflMax</td><td>- threshold: maximum expected reflectance of biometeors </td></tr>
    <tr><td class="paramname">maxAltitude</td><td>- threshold: maximum expected altitude of biometeors </td></tr>
    <tr><td class="paramname">reflDev</td><td>- fuzzy width of <code>reflMax</code> </td></tr>
    <tr><td class="paramname">devAltitude</td><td>- fuzzy width of <code>maxAltitude</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line">rack volume.h5  --aBiomet &#39;&#39;-10,500,5,1000&#39;&#39;  -o andre-biomet.h5</div><div class="line"></div><div class="line">  # reflMax=-10 [dBZ]</div><div class="line">  # maxAltitude=500 [m]</div><div class="line">  # reflDev=5 [dBZ]</div><div class="line">  # devAltitude=1000 [m]</div></div><!-- fragment --><div class="image">
<img src="result-biomet.png" alt="result-biomet.png"/>
<div class="caption">
Detection results of <code>--aBiomet</code> .</div></div>
<h2><a class="anchor" id="aBiomet2"></a>
Detecting birds and insects (dual-pol)</h2>
<p>There is also detectors for birds and insects using dual-pol data.</p>
<div class="fragment"><div class="line">rack volume.h5  --aBird &#39;&#39;-5,5,0.7,2,2500,5&#39;&#39;  -o andre-bird.h5</div><div class="line"></div><div class="line">  # dbzPeak=-5 [Typical reflectivity (DBZH)]</div><div class="line">  # vradDevMin=5 [Minimum of bin-to-bin Doppler speed (VRAD) deviation (m/s)]</div><div class="line">  # rhoHVmax=0.7 [Maximum rhoHV value (fuzzy)]</div><div class="line">  # zdrDevMin=2 [Minimum std.deviation of ZDR (fuzzy)]</div><div class="line">  # windowWidth=2500 [window width, beam-directional (m)]</div><div class="line">  # windowHeight=5 [window width, azimuthal (deg)]</div></div><!-- fragment --><div class="image">
<img src="result-bird.png" alt="result-bird.png"/>
<div class="caption">
Detection results of <code>--aBird</code> .</div></div>
<div class="fragment"><div class="line">rack volume.h5  --aInsect &#39;&#39;-10,-5,0.7,3,2500,5&#39;&#39;  -o andre-insect.h5</div><div class="line"></div><div class="line">  # dbzPeak=-10 [Typical reflectivity (DBZH)]</div><div class="line">  # vradDevMin=-5 [Minimum of bin-to-bin Doppler speed (VRAD) deviation (m/s)]</div><div class="line">  # rhoHVmax=0.7 [Maximum rhoHV value (fuzzy)]</div><div class="line">  # zdrDevMin=3 [Minimum std.deviation of ZDR (fuzzy)]</div><div class="line">  # windowWidth=2500 [window width, beam-directional (m)]</div><div class="line">  # windowHeight=5 [window width, azimuthal (deg)]</div></div><!-- fragment --><div class="image">
<img src="result-insect.png" alt="result-insect.png"/>
<div class="caption">
Detection results of <code>--aInsect</code> .</div></div>
<h2><a class="anchor" id="aClutter"></a>
Detecting ground clutter</h2>
<p>Based on pre-computed clutter map, scales the clutter probability for desired sweeps. The scaling is a heuristic. The loaded map should contain quantity <code>CLUTTER</code> which in each bin represents the probability of contamination. Notice that the quantity does not describe the intensity of contamination, yet might be computed from accumulated dBZ values as described in cluttermaps .</p>
<ul>
<li>alpha <img class="formulaInl" alt="$ \alpha = \angle(b,c)$" src="form_125.png"/>: "sky angle", Default constructor. <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">decay</td><td>- percentage of clutter probability remaining for each 1000m lift in altitude.</td></tr>
  </table>
  </dd>
</dl>
Before applying this operator (by calling processVolume), <code>cluttermap</code> has to be read first. In <b>rack</b> , this is implemented with AnDReClutterMapRead, "--aClutterMapRead" in command line.</li>
</ul>
<p>This operator is <em>universal</em> , it is computed on dBZ but it applies also to str radar parameters measured (VRAD etc)</p>
<div class="fragment"></div><!-- fragment --><div class="image">
<img src="result-cluttermap.png" alt="result-cluttermap.png"/>
<div class="caption">
Detection results of <code>--aClutterMap</code> .</div></div>
<h2><a class="anchor" id="aDopplerNoise"></a>
Detecting noise in Doppler wind</h2>
<p>A faster yet less reliable bird detection is available as <code>aDopplerNoise</code> which computes standard deviation much in the same way the corresponding meteorological motion product <a class="el" href="motionpage.html#dopplerDev">Doppler wind variation</a> . It takes thres parameters: speed <code>threshold</code> (m/s) as well as window width and height. The obtained deviation is converted to a detection probability by means of a fuzzy bell function.</p>
<div class="fragment"><div class="line">rack volume.h5  --aDopplerNoise &#39;&#39;5,2500,5&#39;&#39;  -o andre-dopplerNoise.h5</div><div class="line"></div><div class="line">  # vradDevMin=5 [Minimum of bin-to-bin Doppler speed (VRAD) deviation (m/s)]</div><div class="line">  # windowWidth=2500 [window width, beam-directional (m)]</div><div class="line">  # windowHeight=5 [window width, azimuthal (deg)]</div></div><!-- fragment --><div class="image">
<img src="result-dopplerNoise.png" alt="result-dopplerNoise.png"/>
<div class="caption">
Detection results of <code>--aDopplerNoise</code> .</div></div>
<h2><a class="anchor" id="aEmitter"></a>
Detecting emitters (electromagnetic interference)</h2>
<p>AnDRe emitter detector takes four parameters: <code>lengthMin</code> (along the beam, kilometres), <code>widthMax</code> (azimuthal degrees) and <code>sensitivity</code> (between 0.0 and 1.0). The current implementation applies median filtering twice on the data: horizontally and vertically. Then, the vertical result is subtracted from the horizontal, revealing the horizontally elongated line segments. The computed medians are biased; instead of the conventional median position (at 0.5 of the cumulative distribution) one may lighten or darken the results with the sensitivity value. A high value darkens the vertical result and lightens the horizontal result, causing more line segments in the resulting detection field.</p>
<div class="fragment"><div class="line">rack volume.h5  --aEmitter &#39;5,5,0.75&#39;  -o andre-emitter.h5</div><div class="line"></div><div class="line">  # lengthMin=5 [km]</div><div class="line">  # thicknessMax=5 [deg]</div><div class="line">  # sensitivity=0.5 [0...1]</div></div><!-- fragment --><div class="image">
<img src="result-emitter.png" alt="result-emitter.png"/>
<div class="caption">
Detection results of <code>--aEmitter</code> .</div></div>
 <h2><a class="anchor" id="aJamming"></a>
Detecting jamming</h2>
<p>In presense of intensive nearby transmitters or receiver malfunction radar data can be contaminated by pronounced overall noise. <b>Rack</b> models the shape of such intensity as a function of distance and applies curve fitting to distinguish between smoothly matching noise areas and pronounced meteorological targets.</p>
<div class="fragment"><div class="line">rack volume.h5  --aJamming &#39;&#39;5,80,2,-1&#39;&#39;  -o andre-jamming.h5</div><div class="line"></div><div class="line">  # smoothnessThreshold=5 [dBZ]</div><div class="line">  # distanceMin=80 [km]</div><div class="line">  # weightLower=2 [[0.0...1.0]]</div><div class="line">  # debugRow=-1 [index]</div></div><!-- fragment --><div class="image">
<img src="result-jamming-noise.png" alt="result-jamming-noise.png"/>
<div class="caption">
Detection results of <code>--aJamming</code> .</div></div>
 <div class="image">
<img src="result-jamming.png" alt="result-jamming.png"/>
<div class="caption">
Detection results of <code>--aJamming</code> .</div></div>
 <h2><a class="anchor" id="aRhoHVLow"></a>
Detecting sea clutter and other non-meteorogical targets</h2>
<p>With the polarimetric quantity <em>RhoHV</em> one can easily detect some non-meteorological echoes such as sea clutter. For meteorological targets, <em>RhoHV</em> is close to 1.0 and below otherwise. For example, sea clutter can be detected with the following command:</p>
<div class="fragment"><div class="line">rack volume.h5  --aRhoHVLow &#39;&#39;0.85,0.1,0,0,0.95&#39;&#39;  -o andre-rhohvlow.h5</div><div class="line"></div><div class="line">  # threshold=0.85 [0...1]</div><div class="line">  # thresholdWidth=0.1 [0...1]</div><div class="line">  # windowWidth=0 [metres]</div><div class="line">  # windowHeight=0 [degrees]</div><div class="line">  # medianPos=0.95 [0...1]</div></div><!-- fragment --><div class="image">
<img src="result-rhohvlow.png" alt="result-rhohvlow.png"/>
<div class="caption">
Detection results of <code>--aRhoHVLow</code> .</div></div>
 <h2><a class="anchor" id="aShip"></a>
Detecting ships</h2>
<p>The ship detector takes four parameters: <code>minDBZ</code> (minimum reflectance), <code>devDBZ</code> (minimum reflectance difference in a neighborhood), <code>windowWidth</code> (neighbourhood's beam-directional width, metres), <code>windowHeight</code> (neighbourhood's azimuthal width, degrees). First, the detector function computes two separate fields: a fuzzy remapping of <code>minDBZ</code> and field resulting from high-pass filtering with given neighbourhood. Basically, the result is a fuzzy multiplication of those. In addition, artificial vertical "ship sidelobes" are computed for the latter field, modelling the radar echoes of highly reflective point targets. If the sidelobes also appear in the fuzzy intensity field, they become included in the final result.</p>
<div class="fragment"><div class="line">rack volume.h5  --aShip &#39;&#39;25,15,1500,3&#39;&#39;  -o andre-ship.h5</div><div class="line"></div><div class="line">  # reflMin=25 [dBZ]</div><div class="line">  # reflDev=15 [dBZ]</div><div class="line">  # windowWidth=1500 [m]</div><div class="line">  # windowHeight=3 [deg]</div></div><!-- fragment --><div class="image">
<img src="result-ship.png" alt="result-ship.png"/>
<div class="caption">
Detection results of <code>--aShip</code> .</div></div>
<h2><a class="anchor" id="aSpeckle"></a>
Detecting speckle noise</h2>
<p>Speckle detection needs two parameters: <code>threshold</code> (in dBZ) and <code>area</code> (fuzzy maximal speck size). This detector focuses on distinct, small specks, giving maximum value to single-pixel segments, and progressively smaller values for larger segments. The speckle detector applies a semi-recursive flood-fill type function in computing segment sizes: the image is traversed and each segment having intensity of at least <code>threshold</code> becomes analyzed. The size of each segment fuzzily converted to an intensity of equally shaped segment in the result image.</p>
<div class="fragment"><div class="line">rack volume.h5  --aSpeckle &#39;&#39;0,9&#39;&#39;  -o andre-speckle.h5</div><div class="line"></div><div class="line">  # reflMin=0 [dBZ]</div><div class="line">  # area=9 [bins]</div></div><!-- fragment --><div class="image">
<img src="result-speckle.png" alt="result-speckle.png"/>
<div class="caption">
Detection results of <code>--aSpeckle</code> .</div></div>
<h2><a class="anchor" id="aSun"></a>
Detecting the Sun</h2>
<p>This detector calculates the position of the Sun and marks its with sector of given width and intensity. The detector does not analyse the data itself; sectors will be marked also inside precipitation.</p>
<div class="fragment"><div class="line">rack volume.h5  --aSun &#39;&#39;1,0.5&#39;&#39;  -o andre-sun.h5</div><div class="line"></div><div class="line">  # width=1 [deg]</div><div class="line">  # sensitivity=0.5 [0...1]</div></div><!-- fragment --><div class="image">
<img src="result-sun.png" alt="result-sun.png"/>
<div class="caption">
Detection results of <code>--aSun</code> .</div></div>
<h1><a class="anchor" id="andreCumulation"></a>
Cumulating quality fields</h1>
<p>Typically, user wants to detect several different types of anomalies. In the ODIM structure, <b>Rack</b> creates new data arrays for storing detection results:</p><ol type="1">
<li>An overall result (maximum) of all the detection operators executed, stored in <code>/dataset</code>??/data??/quality1, with <code>what:quantity=QIND</code> </li>
<li>If <code>&ndash;store</code> intermediate=1 has been called, all the intermediate detection results in <code>/dataset</code>??/data??/quality{N} where <code>{N}</code> is an index starting from 2, with <code>what:quantity=PROB-xxx</code> (non-standard)</li>
</ol>
<p><b>Universality</b>. Some detectors like <code>&ndash;aSpeckle</code> are <em>universal</em> , they apply not only for the quantity they have been computed on (like <code>DBZH</code>) but also other quantities (like <code>VRAD</code>). The resulting quality information is stored respectively to dataset level or data level. This policy can be toggled with <code>&ndash;aUniversal</code> .</p>
<p>The resulting cumulative field with <code>what:quantity=QIND</code> is inverted, reflecting the probability of <em>meteorological</em> echoes, ie. quality of the data. In parallel, the classification field with <code>what:quantity=CLASS</code> is updated. The fields are updated automatically after every detection command. They reside on the dataset level or data level, depending on detector universality described above.</p>
<p>In the removal stage, <b>AnDRe</b> combines the <code>QIND</code> and <code>CLASS</code> fields automatically. One may also combine the fields with <code>&ndash;aCombine</code> .</p>
 <div class="image">
<img src="andre-detected-hdfview.png" alt="andre-detected-hdfview.png"/>
<div class="caption">
Cumulative field (top window) and distinct detection results (underlying windows).</div></div>
<h1><a class="anchor" id="andreremoval"></a>
Anomaly removal</h1>
<p>After applying preferred detectors, original data in the volume can be enhanced with the help of the overall quality field, <code>/dataset1/quality/data</code> .</p>
<p>There are three techniques available for the removal:</p><ol type="1">
<li>erasing: replacing values with <code>nodata</code> </li>
<li>damping: turning values down</li>
<li>gap filling: replacing values with surrounding values having better quality</li>
</ol>
<p>The <code>&ndash;aRemover</code> command simply replaces data values with <code>nodata</code> in locations where the quality (anomaly probability) is lower than a threshold: </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume-anomalous.h5  &lt;...detection commands...&gt; --aRemover 0.5  -o andre-removed.h5</div></div><!-- fragment --><p> By default, <code>aRemover</code> applies to practically all quantities (DBZH,TH,VRAD,RHOHV,...). This behaviour can be changed with <code>&ndash;select</code> command.</p>
 <div class="image">
<img src="volume-anom-sea-remover-panel.png" alt="volume-anom-sea-remover-panel.png"/>
<div class="caption">
A sweep corrected by <code>--aRemover</code> with threshold 0.25 (left) and 0.75 (right).</div></div>
<p>A smooth erasure function is implemented as <code>&ndash;aDamper</code> which decreases intensity proportionally to the quality index. It applies to reflectivity data (DBZH) only. The lower the quality index, the more intensity will be decreased. An example of the erasing approach: </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume-anomalous.h5  &lt;...detection commands...&gt; --aDamper 0.5 -o andre-damped.h5</div></div><!-- fragment --><p>The parameter defines the threshold quality. The bin values below the quality threshold will be smoothly erased.</p>
 <div class="image">
<img src="volume-anom-sea-damper-panel.png" alt="volume-anom-sea-damper-panel.png"/>
<div class="caption">
A sweep corrected by <code>--aDamper</code> with threshold 0.25 (left) and 0.5 (right).</div></div>
<p>Gap filling means replacing single values with neighboring, more reliable values. An example of the gap filling approach: </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume-anomalous.h5  &lt;...detection commands...&gt;  --aGapFill 2000m,5deg  -o andre-gapfilled.h5</div></div><!-- fragment --><p>The parameters of <code>aGapFill</code> are window width and height as metres and azimuthal degrees, respectively. Internally, this operator is implemented using 8-directional <em>distance</em> <em>transform</em>.</p>
 <div class="image">
<img src="volume-anom-sea-gapFill-panel.png" alt="volume-anom-sea-gapFill-panel.png"/>
<div class="caption">
A sweep corrected with gap fill parameters 1500m,3deg (left) and 2500m,7deg (right).</div></div>
<p>Another, experimental gap filling operator <code>&ndash;aGapFillRec</code> is recursive and produces spline-like correction fields. The result is smoother but slower to compute. Internally, this operator is implemented by repeating a weighted averaging window.</p>
<p>The removal command can be applied together, for example: </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume-anomalous.h5  &lt;...detection commands...&gt;  --aDamper 0.5,0.1  --aGapFill 1500m,7deg  -o andre-corrected.h5</div></div><!-- fragment --><h1><a class="anchor" id="otherQuality"></a>
Other quality fields</h1>
<p>Detection based quality fields like the ones explained above describe the probability of signals originating from other than desired targets (that is, other than precipitation, typically). In addition to those, <b>Rack</b> provides two operators that describe the quality.</p>
<h2><a class="anchor" id="aCCor"></a>
Using Doppler filtering result</h2>
<p>If both the total reflectivity (<code>TH</code> ) and Dopller filtered reflectivity are available, their difference provides information where the radar has detected static i.e. suspicious targets. The <code>CCor</code> operator computes the diffence between these and fuzzifies the result such that at the given threshold reflecitivy difference the probability of anomaly is 0.5.</p>
<div class="fragment"><div class="line">rack volume.h5  --aCCor &#39;&#39;40&#39;&#39;  -o andre-cCor.h5</div><div class="line"></div><div class="line">  # reflHalfWidth=40 [dBZ]</div></div><!-- fragment --><div class="image">
<img src="result-cCor.png" alt="result-cCor.png"/>
<div class="caption">
Detection results of <code>--aCCor</code> .</div></div>
 <p>Note that this field should NOT be used for removing echoes; the radar has already cleaned data in signal processor. However, this operator should be computed after removal operators (if applied). The resulting (total) quality field can be used in further production, like quality based compositing in which input bins of lower quality will be overridden by other, overlapping bins of higher quality.</p>
<h2><a class="anchor" id="aTime"></a>
Timing based quality</h2>
<p>Likewise, we can associate timing based quality field that describes the extent in which each measurement bin is representative of the nomimal time of the volume or some other desired time, like the nominal time of a composite.</p>
<div class="fragment"><div class="line">rack volume.h5  --aTime &#39;20130504023010,1,5&#39;  -o andre-time.h5</div><div class="line"></div><div class="line">  # time=NOMINAL [NOMINAL,NOW,&lt;YYYYmmddMMHH&gt;]</div><div class="line">  # decayPast=1 [mins]</div><div class="line">  # decayFuture=-1 [mins]</div></div><!-- fragment --><div class="image">
<img src="result-time.png" alt="result-time.png"/>
<div class="caption">
'Detection' results of <code>--aTime</code> .</div></div>
 </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
