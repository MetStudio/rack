<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>File input and output</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="rack.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="rack-logo-110x55.png"/></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Sections</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">File input and output </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>Rack</b> supports reading sweep and volume files in HDF5 format using OPERA information model (ODIM). In addition, supports reading and writing data as images and text files.</p>
<h1><a class="anchor" id="fileio_h5"></a>
Reading and writing HDF5 files</h1>
<p>Input files are given as plain arguments or alternatively with explicit command <code>&ndash;inputFile</code> , abbreviated <code>-i</code>. If several files are given, they will be internally combined in the internal HDF5 structure, adding datasets incrementally.</p>
<p>Outputs are generated using <code>&ndash;outputFile</code> , abbreviated <code>-o</code>. Hence, combining sweep files to a volume is obtained simply with </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> sweep1.h5 sweep2.h5 sweep3.h5  -o volume-combined.h5 </div></div><!-- fragment --><p>In combining sweep data to volumes, <b>Rack</b> creates and updates one <code>/dataset&lt;i&gt;</code> group for each <em>elevation</em> <em>angle</em> . Further, <b>Rack</b> creates and updates one <code>/data&lt;i&gt;</code> group for each <em>quantity</em> ; new input overwrites existing data of the same quantity.</p>
<p>If quality information &ndash; stored under some <code>/quality</code>[i] group and marked with <code>what:quantity=QIND</code> &ndash; is read, the overall quality indices are updated automatically. See <a class="el" href="fileiopage.html#file_quality">Reading and combining quality data</a> below for further details.</p>
 <div class="image">
<img src="volume-hdfview-small.png" alt="volume-hdfview-small.png"/>
<div class="caption">
A volume combined from three separate files (illustrated with HDFview).</div></div>
<h1><a class="anchor" id="fileio_txt"></a>
Reading and writing text files</h1>
<p>Using <code>&ndash;outputFile</code> , the <em>structure</em> of the current data can be written as plain text in a file (*.txt) or to standard input (-): </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 -o volume.txt</div></div><!-- fragment --><p>File <code>volume.txt</code> will consist of lines of ODIM entries as follows: </p><div class="fragment"><div class="line">dataset1</div><div class="line">dataset1/data1</div><div class="line">dataset1/data1/data</div><div class="line">dataset1/data1/data:image=[500,360]</div><div class="line">dataset1/data1/what</div><div class="line">dataset1/data1/what:gain=0.5</div><div class="line">dataset1/data1/what:nodata=255</div><div class="line">dataset1/data1/what:offset=-32</div><div class="line">dataset1/data1/what:quantity=<span class="stringliteral">&quot;TH&quot;</span></div><div class="line">dataset1/data1/what:undetect=0</div><div class="line">dataset1/data1/how</div><div class="line">dataset1/data1/how:LOG=2.5</div><div class="line">...</div></div><!-- fragment --><p>Note that strings are presented in double quotes and arrays as comma-separated values in brackets.</p>
<p>Based on metadata, it is often handy to automatically compose filenames. This is possible using <code>&ndash;expandVariables</code> as follows. </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --expandVariables -o <span class="stringliteral">&#39;incoming-${NOD}_${what:date}-${what:time}.txt&#39;</span></div></div><!-- fragment --><p> For using format templates and hadling multiple files on a single command line, see <a class="el" href="miscbook.html#templates">Metadata output using text templates</a>.</p>
<p>Volume can be also created using a text file like the one created above, that is, with the desired structure and data types. </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.txt -o volume-<span class="keyword">new</span>.h5</div></div><!-- fragment --><p>One can modify the metadata directly from the command line by means of <code>&ndash;setODIM</code> <code>&lt;path&gt;</code>:&lt;attribute&gt;=&lt;value&gt; command. The command has a special shorthand <code>&ndash;/&lt;path&gt;</code>:&lt;attribute&gt;=&lt;value&gt; . For example: </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5   --/dataset1/how:myKey=myValue          -o volume-<span class="keyword">new</span>.h5</div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5   --/dataset1/how:myKey=123.456          -o volume-<span class="keyword">new</span>.h5</div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5   --/dataset2/data3/what:quantity=<span class="stringliteral">&quot;PROB&quot;</span> -o volume-<span class="keyword">new</span>.h5</div></div><!-- fragment --><p> The second example shows how the storage type can be set in braces; to <code>double</code> in this case (see the list above). The default type is string (#). The third example illustrates how <code>PATH</code> can be a regexp; the attributes in the matching paths will be modified.</p>
<p>Hence, this feature can be used for completing incomplete ODIM metadata or adding arbitrary metadata. The actual radar data can be read or saved as image files as explained below.</p>
<h1><a class="anchor" id="fileio_img"></a>
Reading and writing image files</h1>
<p>In addition to HDF5 format, <b>Rack</b> support three image formats:</p><ul>
<li>Portable Network Graphics (PNG), with (<code></code>.png ) extension</li>
<li>Portable Anymap Format (PNM), grayscale ( <code></code>.pgm ) and RGB images (<code></code>.ppm ).</li>
<li>Geo-Referenced Tagged Image File Format (GeoTIFF, GTIF), (<code></code>.tif ), limited to writing Cartesian grayscale data; GDAL conventions are used in intensity scaling (<code>scale</code> and <code>offset</code> ).</li>
</ul>
<p>When writing data with <code>&ndash;outputFile</code> (<code>-o</code>) command, the applied image format is determined from the filename extension. By default, the first dataset encountered in the internal data structure is selected, hence typically <code>/data1/dataset1/data</code> . The source can be changed with <code>&ndash;select</code> command. </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 -o sweep1.png</div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select dataset2/data:,quantity=DBZH -o sweep1.pgm</div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --cProj <span class="stringliteral">&quot;+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0&quot;</span> -c  -o sweep1.tif</div></div><!-- fragment --><p>Note: in GeoTIFF ouputs, for unknown reasons, certain projections &ndash; for example EPSG:3844, EPSG:3035, and EPSG:3995 &ndash; raise errors in writing projection data. (See <a class="el" href="compositespage.html">Cartesian conversions and composites</a> .)</p>
<div class="image">
<img src="sweep.png" alt="sweep.png"/>
<div class="caption">
A PNG image generated with <code>-o</code> .</div></div>
 <p>Metadata (ODIM variables) are written in the comment lines (PGM and PNM). The syntax follows that of a text dump produced with <code>&ndash;outputFile</code> as explained above with <code>volume.txt</code> , but only the last path component (<code>what</code> , <code>where</code>, <code>how</code>) is included. For example, a resulting header of a PGM file - here pruned for illustration - looks like: </p><div class="fragment"><div class="line">P5</div><div class="line"><span class="preprocessor"># how:freeze=2.1</span></div><div class="line"><span class="preprocessor"># how:highprf=570</span></div><div class="line"><span class="preprocessor"># how:lowprf=570</span></div><div class="line"><span class="preprocessor"># how:polarization=&quot;H+V&quot;</span></div><div class="line"><span class="preprocessor"># how:rpm=2.82074</span></div><div class="line"><span class="preprocessor"># how:task=&quot;PPI1_A&quot;</span></div><div class="line"><span class="preprocessor"># how:wavelength=5.33</span></div><div class="line"><span class="preprocessor"># what:date=&quot;20140827&quot;</span></div><div class="line"><span class="preprocessor"># what:enddate=&quot;20140827&quot;</span></div><div class="line"><span class="preprocessor"># what:endtime=&quot;090022&quot;</span></div><div class="line"><span class="preprocessor"># what:gain=0.5</span></div><div class="line"><span class="preprocessor"># what:nodata=255</span></div><div class="line"><span class="preprocessor"># what:object=&quot;PVOL&quot;</span></div><div class="line"><span class="preprocessor"># what:offset=-32</span></div><div class="line"><span class="preprocessor"># what:product=&quot;SCAN&quot;</span></div><div class="line"><span class="preprocessor"># what:quantity=&quot;DBZH&quot;</span></div><div class="line"><span class="preprocessor"># what:source=&quot;WMO:02870,RAD:FI47,PLC:Utajärvi,NOD:fiuta&quot;</span></div><div class="line"><span class="preprocessor"># what:startdate=&quot;20140827&quot;</span></div><div class="line"><span class="preprocessor"># what:starttime=&quot;090000&quot;</span></div><div class="line"><span class="preprocessor"># what:time=&quot;090000&quot;</span></div><div class="line"><span class="preprocessor"># what:undetect=0</span></div><div class="line"><span class="preprocessor"># where:elangle=0.3</span></div><div class="line"><span class="preprocessor"># where:height=118</span></div><div class="line"><span class="preprocessor"># where:lat=64.7749</span></div><div class="line"><span class="preprocessor"># where:lon=26.3189</span></div><div class="line"><span class="preprocessor"># where:nbins=500</span></div><div class="line"><span class="preprocessor"># where:nrays=360</span></div><div class="line"><span class="preprocessor"># where:rscale=500</span></div><div class="line"><span class="preprocessor"># where:rstart=0</span></div><div class="line"><span class="preprocessor"># where:towerheight=33</span></div><div class="line">500 360</div><div class="line">255</div></div><!-- fragment --><p><b>Rack</b> can also save all the data sets in separate files with a single command, producing <code>sweep000.png</code> , <code>sweep001.png</code> and so on. This is achieved with <code>&ndash;outputRawImages</code> , abbreviated -O . The command stores the image data directly, without rescaling pixel values.</p>
<p><b>Reading</b> image files creates and updates internal HDF5 structure, adding grid data:</p><ol type="1">
<li>in the first encountered <code>/data&lt;i&gt;</code> or <code>/quality&lt;i&gt;</code> group containing an empty <code>/data</code> (ie. uninitialized image), or if not found:</li>
<li>in a new <code>/data&lt;i&gt;/data</code> of the existing <code>/dataset&lt;j&gt;</code> with the highest index <code>j</code> </li>
</ol>
<p>Metadata can be set</p><ol type="1">
<li>by reading them directly from image file comments (text supported by PNG and PNM formats, e.g. <code>what:quantity="DBZH"</code> )</li>
<li>by inputting a text file as explained above</li>
<li>on the command line, like <code>&ndash;/dataset1/data2/what</code>:quantity=DBZH (see <a class="el" href="index.html#changing">Changing attribute values</a>)</li>
</ol>
<p>Metadata can be set before or after image inputs. Example: </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.txt sweep1.png --/dataset1/data1/where:rscale=500  &lt;commands&gt;</div></div><!-- fragment --><h1><a class="anchor" id="histograms"></a>
Histograms</h1>
<div class="fragment"><div class="line">--histogram  &lt;count&gt;,&lt;range&gt;,&lt;filename&gt;,&lt;store&gt;</div><div class="line">  Histogram. Optionally --format using keys index,min,max,count,label</div><div class="line">    count=256 </div><div class="line">    range=0:0 </div><div class="line">    filename= [&lt;filename&gt;.txt|-]</div><div class="line">    store=histogram [&lt;attribute_key&gt;]</div></div><!-- fragment --><p>Example: </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select <span class="stringliteral">&#39;quantity=TH&#39;</span> --histogram filename=histogram.dat</div></div><!-- fragment --><p>The resulting file consists of lines containing values and counts </p><div class="fragment"><div class="line"><span class="preprocessor"># [0,256] </span></div><div class="line">97192 # <span class="stringliteral">&#39;undetect&#39;</span> (0) [-32, -31.5] </div><div class="line">0 # <span class="stringliteral">&#39;&#39;</span> (1) [-31.5, -31] </div><div class="line">0 # <span class="stringliteral">&#39;&#39;</span> (2) [-31, -30.5] </div><div class="line">0 # <span class="stringliteral">&#39;&#39;</span> (3) [-30.5, -30] </div><div class="line">0 # <span class="stringliteral">&#39;&#39;</span> (4) [-30, -29.5] </div><div class="line">0 # <span class="stringliteral">&#39;&#39;</span> (5) [-29.5, -29] </div><div class="line">0 # <span class="stringliteral">&#39;&#39;</span> (6) [-29, -28.5] </div><div class="line">0 # <span class="stringliteral">&#39;&#39;</span> (7) [-28.5, -28] </div><div class="line">0 # <span class="stringliteral">&#39;&#39;</span> (8) [-28, -27.5] </div><div class="line">0 # <span class="stringliteral">&#39;&#39;</span> (9) [-27.5, -27] </div><div class="line">0 # <span class="stringliteral">&#39;&#39;</span> (10) [-27, -26.5] </div><div class="line">0 # <span class="stringliteral">&#39;&#39;</span> (11) [-26.5, -26] </div><div class="line">0 # <span class="stringliteral">&#39;&#39;</span> (12) [-26, -25.5] </div><div class="line">0 # <span class="stringliteral">&#39;&#39;</span> (13) [-25.5, -25] </div><div class="line">0 # <span class="stringliteral">&#39;&#39;</span> (14) [-25, -24.5] </div><div class="line">1 # <span class="stringliteral">&#39;&#39;</span> (15) [-24.5, -24] </div><div class="line">0 # <span class="stringliteral">&#39;&#39;</span> (16) [-24, -23.5] </div><div class="line">1 # <span class="stringliteral">&#39;&#39;</span> (17) [-23.5, -23] </div><div class="line">1 # <span class="stringliteral">&#39;&#39;</span> (18) [-23, -22.5] </div><div class="line"></div><div class="line">...</div><div class="line">    ...</div><div class="line">        ...</div><div class="line">0 # <span class="stringliteral">&#39;&#39;</span> (252) [94, 94.5] </div><div class="line">0 # <span class="stringliteral">&#39;&#39;</span> (253) [94.5, 95] </div><div class="line">0 # <span class="stringliteral">&#39;&#39;</span> (254) [95, 95.5] </div><div class="line">0 # <span class="stringliteral">&#39;nodata&#39;</span> (255) [95.5, 96] </div><div class="line"></div></div><!-- fragment --><p>Example: </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume-detected.h5 --select <span class="stringliteral">&#39;data:/quality:,quantity=CLASS&#39;</span> --format <span class="stringliteral">&#39;${index}\t${count}\t # ${label}\n&#39;</span> --histogram filename=histogram2.dat</div></div><!-- fragment --><div class="fragment"><div class="line"># [0,256] </div><div class="line">0   89938    # undetect</div><div class="line">1   0    # </div><div class="line">2   0    # </div><div class="line">3   0    # </div><div class="line">4   0    # </div><div class="line">5   0    # </div><div class="line">6   0    # </div><div class="line">7   0    # </div><div class="line">8   0    # </div><div class="line">9   0    # </div><div class="line">10  0    # </div><div class="line">11  0    # </div><div class="line">12  0    # </div><div class="line">13  0    # </div><div class="line">14  0    # </div><div class="line">15  0    # </div><div class="line">16  0    # </div><div class="line">17  0    # </div><div class="line">18  0    # </div><div class="line">19  0    # </div><div class="line">20  0    # </div><div class="line">21  0    # </div><div class="line">22  0    # </div><div class="line">23  0    # </div><div class="line">24  0    # </div><div class="line">25  0    # </div><div class="line">26  0    # </div><div class="line">27  0    # </div><div class="line">28  0    # </div><div class="line">29  0    # </div><div class="line">30  0    # </div><div class="line">31  0    # </div><div class="line">32  0    # </div><div class="line">33  0    # </div><div class="line">34  0    # </div><div class="line">35  0    # </div><div class="line">36  0    # </div><div class="line">37  0    # </div><div class="line">38  0    # </div><div class="line">39  0    # </div><div class="line">40  0    # </div><div class="line">41  0    # </div><div class="line">42  0    # </div><div class="line">43  0    # </div><div class="line">44  0    # </div><div class="line">45  0    # </div><div class="line">46  0    # </div><div class="line">47  0    # </div><div class="line">48  0    # </div><div class="line">49  0    # </div><div class="line">50  0    # </div><div class="line">51  0    # </div><div class="line">52  0    # </div><div class="line">53  0    # </div><div class="line">54  0    # </div><div class="line">55  0    # </div><div class="line">56  0    # </div><div class="line">57  0    # </div><div class="line">58  0    # </div><div class="line">59  0    # </div><div class="line">60  0    # </div><div class="line">61  0    # </div><div class="line">62  0    # </div><div class="line">63  0    # </div><div class="line">64  0    # </div><div class="line">65  0    # </div><div class="line">66  0    # </div><div class="line">67  0    # </div><div class="line">68  0    # </div><div class="line">69  0    # </div><div class="line">70  0    # </div><div class="line">71  0    # </div><div class="line">72  0    # </div><div class="line">73  0    # </div><div class="line">74  0    # </div><div class="line">75  0    # </div><div class="line">76  0    # </div><div class="line">77  0    # </div><div class="line">78  0    # </div><div class="line">79  0    # </div><div class="line">80  0    # </div><div class="line">81  0    # </div><div class="line">82  0    # </div><div class="line">83  0    # </div><div class="line">84  0    # </div><div class="line">85  0    # </div><div class="line">86  0    # </div><div class="line">87  0    # </div><div class="line">88  0    # </div><div class="line">89  0    # </div><div class="line">90  0    # </div><div class="line">91  0    # </div><div class="line">92  62   # </div><div class="line">93  0    # </div><div class="line">94  0    # </div><div class="line">95  0    # </div><div class="line">96  0    # </div><div class="line">97  0    # </div><div class="line">98  0    # </div><div class="line">99  0    # </div><div class="line">100 0    # </div><div class="line">101 0    # </div><div class="line">102 0    # </div><div class="line">103 0    # </div><div class="line">104 0    # </div><div class="line">105 0    # </div><div class="line">106 0    # </div><div class="line">107 0    # </div><div class="line">108 0    # </div><div class="line">109 0    # </div><div class="line">110 0    # </div><div class="line">111 0    # </div><div class="line">112 0    # </div><div class="line">113 0    # </div><div class="line">114 0    # </div><div class="line">115 0    # </div><div class="line">116 0    # </div><div class="line">117 0    # </div><div class="line">118 0    # </div><div class="line">119 0    # </div><div class="line">120 0    # </div><div class="line">121 0    # </div><div class="line">122 0    # </div><div class="line">123 0    # </div><div class="line">124 0    # </div><div class="line">125 0    # </div><div class="line">126 0    # </div><div class="line">127 0    # </div><div class="line">128 0    # </div><div class="line">129 0    # </div><div class="line">130 0    # </div><div class="line">131 0    # </div><div class="line">132 0    # </div><div class="line">133 0    # </div><div class="line">134 0    # </div><div class="line">135 0    # </div><div class="line">136 0    # </div><div class="line">137 0    # </div><div class="line">138 0    # </div><div class="line">139 0    # </div><div class="line">140 0    # </div><div class="line">141 0    # </div><div class="line">142 0    # </div><div class="line">143 0    # </div><div class="line">144 0    # </div><div class="line">145 0    # </div><div class="line">146 0    # </div><div class="line">147 0    # </div><div class="line">148 0    # </div><div class="line">149 0    # </div><div class="line">150 0    # </div><div class="line">151 0    # </div><div class="line">152 0    # </div><div class="line">153 0    # </div><div class="line">154 0    # </div><div class="line">155 0    # </div><div class="line">156 0    # </div><div class="line">157 0    # </div><div class="line">158 0    # </div><div class="line">159 0    # </div><div class="line">160 0    # </div><div class="line">161 0    # </div><div class="line">162 0    # </div><div class="line">163 0    # </div><div class="line">164 0    # </div><div class="line">165 0    # </div><div class="line">166 0    # </div><div class="line">167 0    # </div><div class="line">168 0    # </div><div class="line">169 0    # </div><div class="line">170 0    # </div><div class="line">171 0    # </div><div class="line">172 0    # </div><div class="line">173 0    # </div><div class="line">174 0    # </div><div class="line">175 0    # </div><div class="line">176 0    # </div><div class="line">177 0    # </div><div class="line">178 0    # </div><div class="line">179 0    # </div><div class="line">180 0    # </div><div class="line">181 0    # </div><div class="line">182 0    # </div><div class="line">183 0    # </div><div class="line">184 0    # </div><div class="line">185 0    # </div><div class="line">186 0    # </div><div class="line">187 0    # </div><div class="line">188 0    # </div><div class="line">189 0    # </div><div class="line">190 0    # </div><div class="line">191 0    # </div><div class="line">192 0    # </div><div class="line">193 0    # </div><div class="line">194 0    # </div><div class="line">195 0    # </div><div class="line">196 0    # </div><div class="line">197 0    # </div><div class="line">198 0    # </div><div class="line">199 0    # </div><div class="line">200 0    # </div><div class="line">201 0    # </div><div class="line">202 0    # </div><div class="line">203 0    # </div><div class="line">204 0    # </div><div class="line">205 0    # </div><div class="line">206 0    # </div><div class="line">207 0    # </div><div class="line">208 0    # </div><div class="line">209 0    # </div><div class="line">210 0    # </div><div class="line">211 0    # </div><div class="line">212 0    # </div><div class="line">213 0    # </div><div class="line">214 0    # </div><div class="line">215 0    # </div><div class="line">216 0    # </div><div class="line">217 0    # </div><div class="line">218 0    # </div><div class="line">219 0    # </div><div class="line">220 0    # </div><div class="line">221 0    # </div><div class="line">222 0    # </div><div class="line">223 0    # </div><div class="line">224 0    # </div><div class="line">225 0    # </div><div class="line">226 0    # </div><div class="line">227 0    # </div><div class="line">228 0    # </div><div class="line">229 0    # </div><div class="line">230 0    # </div><div class="line">231 0    # </div><div class="line">232 0    # </div><div class="line">233 0    # </div><div class="line">234 0    # </div><div class="line">235 0    # </div><div class="line">236 0    # </div><div class="line">237 0    # </div><div class="line">238 0    # </div><div class="line">239 0    # </div><div class="line">240 0    # </div><div class="line">241 0    # </div><div class="line">242 0    # </div><div class="line">243 0    # </div><div class="line">244 0    # </div><div class="line">245 0    # </div><div class="line">246 0    # </div><div class="line">247 0    # </div><div class="line">248 0    # </div><div class="line">249 0    # </div><div class="line">250 0    # </div><div class="line">251 0    # </div><div class="line">252 0    # </div><div class="line">253 0    # </div><div class="line">254 0    # </div><div class="line">255 0    # nodata</div><div class="line"></div></div><!-- fragment --><h1><a class="anchor" id="graphs"></a>
Illustrating data structure</h1>
<p><b>Rack</b> can be also used to output the tree-like hierarchy of radar data in <code>dot</code> format (<a href="http://www.graphviz.org/documentation/">http://www.graphviz.org/documentation/</a>). From that format, one may use Graphviz <code>dot</code> program to produce tree graphs in various image formats link <code>png</code> , <code>pdf</code> and <code>svg</code>. For example:</p>
<div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --keep dataset1:2/data1:3 -o volume-tree.dot</div><div class="line"><span class="preprocessor"># Currently --keep preferred to --select </span></div><div class="line"></div><div class="line">dot volume-tree.dot -Tpng -o volume-tree.png</div><div class="line">dot volume-tree.dot -Tpdf -o volume-tree.pdf</div></div><!-- fragment --><p>The desired path can be selected with <code>&ndash;select</code> path=&lt;group&gt;[/&lt;group&gt;] or simply <code>&ndash;select</code> &lt;group&gt;[/&lt;group&gt;] because path is the first argument key. The most relevant groups are <code>dataset:</code> , and <code>data:</code> , and <code>quality:</code> . The colon <code></code>: is compulsory for separating <code>data&lt;index&gt;</code> groups from lower level <code>data</code> group in ODIM. In the current version, groups <code>what</code> , <code>what</code> and <code>how</code> are handled somewhat automagically. (See <a class="el" href="index.html#selecting">Selecting data</a> .)</p>
 <div class="image">
<img src="volume-tree.png" alt="volume-tree.png"/>
<div class="caption">
Data structure illustrations creating by means of <code>dot</code> file output.</div></div>
<h1><a class="anchor" id="file_details"></a>
Technical details</h1>
<h2><a class="anchor" id="file_quality"></a>
Reading and combining quality data</h2>
<p>In an operative environment, two parallel processes may perform quality control. <b>Rack</b> intelligently combines the resulting files using the following logic:</p>
<ul>
<li>The main quality field (<code>quantity=QIND</code> ) is updated, based on either target class field (<code>quantity=CLASS</code>) or (<code>quantity=&lt;class-name&gt;</code> ):<ol type="1">
<li>If overall classification (<code>quantity=CLASS</code>) is provided, <code>QIND</code> and <code>CLASS</code> will be updated directly from those.</li>
<li>If <code>CLASS</code> is not provided, <code>QIND</code> will be updated from the specific class probability (<code>quantity=&lt;class-name&gt;</code> ).</li>
</ol>
</li>
<li>Under the group containing <code>QIND</code> (typically <code>/quality1</code> ), <code>how:task_args</code> will be updated by the names of the added classes.</li>
</ul>
<p>In the following example, the quantities (detection classes) applied are those produced by <b>Rack</b> but could be thought as if they were produced by some other software, with same or similar names.</p>
<p>Consider two quality control processes, the first producing detection of <code>EMITTER</code> and <code>JAMMING</code> , stored in file <code>volume-det1.h5</code> , containing following data (among others):</p>
<div class="fragment"></div><!-- fragment --><p>Assume the other process detecting <code>SHIP</code> and <code>SPECKLE</code> stored in <code>volume-det2.h5</code> , respectively:</p>
<div class="fragment"><div class="line">dataset1/data1/what:quantity=<span class="stringliteral">&quot;TH&quot;</span></div><div class="line">dataset1/data2/quality1/what:quantity=<span class="stringliteral">&quot;QIND&quot;</span></div><div class="line">dataset1/data2/quality2/what:quantity=<span class="stringliteral">&quot;CLASS&quot;</span></div><div class="line">dataset1/data2/quality3/what:quantity=<span class="stringliteral">&quot;SHIPOP&quot;</span></div><div class="line">dataset1/data2/what:quantity=<span class="stringliteral">&quot;DBZH&quot;</span></div><div class="line">dataset1/data4/what:quantity=<span class="stringliteral">&quot;WRAD&quot;</span></div><div class="line">dataset1/quality1/what:quantity=<span class="stringliteral">&quot;QIND&quot;</span></div><div class="line">dataset1/quality2/what:quantity=<span class="stringliteral">&quot;CLASS&quot;</span></div><div class="line">dataset1/quality3/what:quantity=<span class="stringliteral">&quot;SPECKLEOP&quot;</span></div></div><!-- fragment --><p>These files can be combined simply with </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume-det1.h5 volume-det2.h5  -o volume-det-combined.h5</div></div><!-- fragment --><p>The resulting file contains structure as follows: </p><div class="fragment"><div class="line">dataset1/data2/quality1/what:quantity=<span class="stringliteral">&quot;QIND&quot;</span></div><div class="line">dataset1/data2/quality2/what:quantity=<span class="stringliteral">&quot;CLASS&quot;</span></div><div class="line">dataset1/data2/quality3/what:quantity=<span class="stringliteral">&quot;EMITTEROP&quot;</span></div><div class="line">dataset1/data2/quality4/what:quantity=<span class="stringliteral">&quot;SHIPOP&quot;</span></div><div class="line">dataset1/data2/what:quantity=<span class="stringliteral">&quot;DBZH&quot;</span></div><div class="line">dataset1/data3/what:quantity=<span class="stringliteral">&quot;TH&quot;</span></div><div class="line">dataset1/data4/what:quantity=<span class="stringliteral">&quot;WRAD&quot;</span></div><div class="line">dataset1/quality1/what:quantity=<span class="stringliteral">&quot;QIND&quot;</span></div><div class="line">dataset1/quality2/what:quantity=<span class="stringliteral">&quot;CLASS&quot;</span></div><div class="line">dataset1/quality3/what:quantity=<span class="stringliteral">&quot;JAMMINGOP&quot;</span></div><div class="line">dataset1/quality4/what:quantity=<span class="stringliteral">&quot;SPECKLEOP&quot;</span></div><div class="line">...</div></div><!-- fragment --><p>Just like after running several <em>detection</em> processes, after reading files containing detection fields, global ie. elevation-specific quality data (<code>QIND</code> and <code>CLASS</code> ) are not implictly combined to local ie. quantity-specific quality data. As explained in detection , this combination takes place automatically if any removal command or <code>&ndash;c</code> &ndash;aQualityCombiner command is issued. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
