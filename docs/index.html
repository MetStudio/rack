<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Rack - a weather radar data processing program</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="rack.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="rack-logo-110x55.png"/></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Sections</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Rack - a weather radar data processing program </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><em></em> .</p>
 <div class="image">
<img src="rack-logo-384x192.png" alt="rack-logo-384x192.png"/>
</div>
<div class="fragment"><div class="line">Version 5.45</div></div><!-- fragment --><h1><a class="anchor" id="intro"></a>
Introduction</h1>
<p><b>Rack</b> is a command-line program for processing weather radar data. It uses raw measurement data as input and generates <a class="el" href="productspage.html">Meteorological products</a> as well as <a class="el" href="compositespage.html">Cartesian conversions and composites</a> . <b>Rack</b> also provides methods for <a class="el" href="andrepage.html">Anomaly Detection and Removal (AnDRe)</a> . Quality information is supported throughout the processing chain. <b>Rack</b> also support <a class="el" href="imagespage.html">Working with images</a> , like applying colors and transparency.</p>
<p><code>Rack</code> is based on code developed at the Finnish Meteorological Institute since 2001. Recent development work has been also supported by the BALTRAD project, see <a href="http://www.baltrad.eu">http://www.baltrad.eu</a>.</p>
<p>As input, <b>Rack</b> accepts azimuthal scans - volumes or separate sweeps - in HDF5 files using OPERA Information Model (ODIM, <a href="http://www.eumetnet.eu/opera">http://www.eumetnet.eu/opera</a>). The polar coordinate system is applied: the radar at left, rows presenting beams clockwise, the topmost row towards North. After loading a volume, a typical operation is to compute a single-radar product. The computation is carried out in polar coordinates. The result can be mapped to a Cartesian products. The projections are calculated using the Proj4 library (<a href="http://trac.osgeo.org/proj/">http://trac.osgeo.org/proj/</a>). Output files can be written in HDF5 files, PNG image files or geo-referenced GeoTIFF files. In addition, metadata, resampled grid data and vertical profiles can be output as plain text files.</p>
<p>The overall data flow is illustrated below.</p>
<div align="center">
<img src="dot_inline_dotgraph_8.png" alt="dot_inline_dotgraph_8.png" border="0" usemap="#dot_inline_dotgraph_8.map"/>
<map name="dot_inline_dotgraph_8.map" id="dot_inline_dotgraph_8.map"><area shape="rect" id="node1" href="fileiopage.html" title="Input file\nHDF5 (or PNG+TXT)" alt="" coords="4,135,119,174"/>
<area shape="rect" id="node2" href="fileiopage.html" title="Input volume" alt="" coords="159,135,235,174"/>
<area shape="poly" id="node3" href="andrepage.html" title="Anomaly detection\n and removal" alt="" coords="426,155,422,148,412,141,396,136,376,133,354,132,331,133,311,136,295,141,285,148,282,155,285,162,295,168,311,173,331,176,354,177,376,176,396,173,412,168,422,162"/>
<area shape="poly" id="node4" href="productspage.html" title="Product generation\n(in polar coordinates)" alt="" coords="433,90,429,83,418,77,400,72,378,69,354,67,329,69,307,72,290,77,279,83,275,90,279,97,290,104,307,109,329,112,354,113,378,112,400,109,418,104,429,97"/>
<area shape="poly" id="node6" href="compositespage.html" title="Cartesian products\n and compositing" alt="" coords="773,97,770,90,760,83,744,78,725,75,703,74,682,75,662,78,647,83,637,90,633,97,637,104,647,110,662,115,682,118,703,119,725,118,744,115,760,110,770,104"/>
<area shape="rect" id="node9" href="fileiopage.html" title="Output file\nHDF5, GeoTIFF, or PNG" alt="" coords="1020,156,1148,196"/>
</map>
</div>
<h1><a class="anchor" id="commands"></a>
Usage</h1>
<h2><a class="anchor" id="command_line_format"></a>
Command line arguments</h2>
<p>A typical invocation of <b>Rack</b> looks like: </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> &lt;input-files&gt;  &lt;command&gt; -o &lt;file1&gt;   &lt;command2&gt; -o &lt;file2&gt;  ...</div></div><!-- fragment --><p>The native format for data is HDF5, but data and be read or written partially using image and text format. See <a class="el" href="fileiopage.html">File input and output</a> for details.</p>
<p>Specifically, <b>Rack</b> accepts three kinds of command line arguments:</p>
<ol type="1">
<li>options without arguments, like <code>&ndash;help</code> </li>
<li>options with arguments, like <code>&ndash;outputFile</code> <code>product.h5</code> </li>
<li>plain arguments recognized as input filenames, like <code>volume.h5</code> , serving as shorthand for <code>&ndash;inputFile</code> <code>&lt;file&gt;</code> .</li>
</ol>
<p>The options are prefixed with double hyphen, "--". Some options have also a single hyphen "-", single-letter shorthand. (This argument syntax differs from POSIX and GNU conventions, e.g. <code>-x</code> <code>-y</code> cannot be grouped to <code>-xy</code>. ) All the arguments are handled in order; they can be thought as commands to be executed sequentially.</p>
<p>Usage info and a list of commands is dumped if <code>&ndash;help</code> or <code>-h</code> or no arguments are supplied: </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> --help</div></div><!-- fragment --><p> The list of commands is also listed in Section <a class="el" href="quickpage.html#commands_general">General commands</a>.</p>
<p>Help is also available for invidual commands: </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> --help &lt;command&gt;</div></div><!-- fragment --><p>The version of the program is displayed with <code>&ndash;version</code>. Other useful general commands are <code>&ndash;verbose</code> <code>&lt;level&gt;</code> and <code>&ndash;status</code>, which give debugging information of data flow and memory.</p>
<h2><a class="anchor" id="products"></a>
Product generation</h2>
<p>Generation of a single-radar product is explained in section <a class="el" href="productspage.html">Meteorological products</a>. The products are generated in polar coordinates, that is, in radar's native coordinate system. A product may contain additional data arrays, typically quality indices or height information. As processing and using Doppler data involves special aspects, it is handled in it own section, <a class="el" href="motionpage.html#doppler">Basic Doppler products</a>.</p>
<p>A product can be further converted to Cartesian coordinate system, explained next.</p>
<h2><a class="anchor" id="cartesian"></a>
Converting to Cartesian images</h2>
<p>Data in polar coordinates can be mapped to a Cartesian product with <code>&ndash;cCreate</code> (abbreviated <code>-c</code>). The simplest possible command is </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --cCreate -o cartesian.h5</div></div><!-- fragment --><p> which converts the first dataset (sweep) in volume.h5 to a cartesian product. The default projection is azimuthal equidistant, centered at the radar location. The projection can be changed with <code>&ndash;cProj</code> which uses <b>proj4</b> syntax (<a href="http://trac.osgeo.org/proj/">http://trac.osgeo.org/proj/</a>). The default size (bins x bins) can be changed with <code>&ndash;cSize</code> .</p>
<div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --cSize 400,400 --cProj <span class="stringliteral">&#39;+proj=stere +lon_0=25.0 +lat_0=60.000&#39;</span> --cCreate -o cartesian-stere.h5</div></div><!-- fragment --><div class="image">
<img src="cartesians.png" alt="cartesians.png"/>
<div class="caption">
Data remapped with <code>--cCreate</code> , further coloured with <code>--palette</code> , displayed with a legend generated with <code>--legendOut</code> .</div></div>
 <p>The above image contains some anomalies that can be detected and removed. See <a class="el" href="andrepage.html">Anomaly Detection and Removal (AnDRe)</a> for details.</p>
<p>Inside <b>Rack</b> , a single-radar Cartesian product is technically similar to a radar composite &ndash; it is a single-radar "composite". The related commands are prefixed with <code>'c'</code>. Composite generation, projections, methods, and other options are explained in further detail in section <a class="el" href="compositespage.html">Cartesian conversions and composites</a> .</p>
<h2><a class="anchor" id="selecting"></a>
Selecting data</h2>
<p>Selecting data can be done with command <code>&ndash;select</code> .</p>
<div class="fragment"><div class="line">--select, -s  &lt;path&gt;,&lt;quantity&gt;,&lt;elangle&gt;,&lt;count&gt;,&lt;elangleMin&gt;,&lt;elangleMax&gt;</div><div class="line">  Data selection <span class="keywordflow">for</span> the next operation.</div><div class="line">    path= </div><div class="line">    quantity= [DBZH|VRAD|RHOHV|...]</div><div class="line">    elangle=-90:90 [min[:max]]</div><div class="line">    count=1000 </div><div class="line">    elangleMin=-90 [(deprecating)]</div><div class="line">    elangleMax=90 [(deprecating)]</div></div><!-- fragment --><p>Most commands apply implicit input data selection criteria, typically involving data paths, quantities and/or elevation angles.</p>
<p>Like in general in <b>Rack</b>, the parameters of <code>&ndash;select</code> are ordered, meaning that they can be issued as a comma-separated string without explicit key names, as long as they are given in order. Some remarks on parameters:</p>
<ul>
<li><code>path</code> consists of slash '/' separated <em>path</em> <em>selection</em> <em>elements:</em> <ul>
<li>a leading single slash '/', if rooted matching is desired ie. leading parts of the paths are tested; otherwise trailing parts</li>
<li><code>what</code> , <code>where</code>, <code>how</code> - groups containing attributes</li>
<li><code> dataset&lt;min&gt;:&lt;max&gt; </code>, <code> data&lt;min&gt;:&lt;max&gt;</code> , <code> quality&lt;min&gt;:&lt;max&gt;</code> - indexed groups containing subgroups for actual data and attributes</li>
<li><code>data</code> - unindexed groups containing actual data arrays</li>
<li><em>combined</em> <em>selection</em> <em>elements</em> created by concatenating above elements with pipe '|' representing logical OR function (requires escaping on command line)<ul>
<li>example: <code>what|where|dataset1:3</code></li>
</ul>
</li>
<li>in index ranges, values can be omitted, using invoking default minimum (1) and maximum (0xffff = 65535) as follows:<ul>
<li><code>data:</code> equals <code>data1:65535</code>; further the colon ':' can be omitted for <code>dataset</code> and <code>quality</code> (but not for <code>data:</code> , to bypass naming conflict inherent in ODIM )</li>
<li><code>data&lt;index&gt;</code> equals <code> data&lt;index&gt;:&lt;index&gt;</code> (ie. exact match)</li>
<li><code>data&lt;index&gt;:</code> equals <code> data&lt;index&gt;:65535</code></li>
<li><code>data:&lt;index&gt;</code> equals <code> data1:&lt;index&gt;</code></li>
</ul>
</li>
<li>in each combined selection element, only one index range can be given, referring to all indexed elements, and it must be given as the last segment<ul>
<li>example: <code>what|data|quality1:5</code> matches <code>what</code>, <code>data1:5</code> and <code>quality1:5</code></li>
<li>example: <code>what|where|dataset1:3/what|data1:8</code> &ndash; index ranges <em>can</em> <em>vary</em> on different levels, ie. in slash-separated elements</li>
</ul>
</li>
</ul>
</li>
<li><code>quantity</code> is a regular expression<ul>
<li>example: <code>^DBZH$</code>, accepting <code>DBZH</code> only</li>
<li>example: <code>(DBZH|TH)</code> accepts <code>DBZH</code> and <code>TH</code> , but also <code>DBZHC</code> and <code>WIDTH</code> ...</li>
<li>future option: two regular expressions separated by a slash, the latter regExp determining the desired quality quantities</li>
</ul>
</li>
<li><code>elangle</code> defines the range of antenna elevations accepted, range limits included<ul>
<li>unlike with path selectors, &gt;c&gt;elangle=&lt;angle&gt; abbreviates <code>elangle=&lt;angle&gt;:90</code> (not <code>elangle=&lt;angle&gt;:&lt;angle&gt;</code>)</li>
<li>notice that radar metadata may contain real(ized) values like 1.000004723, use <code>count=1</code> to pick a single one within a range</li>
</ul>
</li>
<li><code>count</code> is the upper limit of accepted indices of <code>dataset</code> ; typically used with <code>elangle</code> </li>
</ul>
<p>The selection functionality is best explained with examples.</p>
<div class="fragment"><div class="line"><span class="preprocessor"># For text output, select paths STARTING with &#39;dataset2&#39;, &#39;dataset3&#39;, ..., &#39;dataset5&#39;. </span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select /dataset2:5 -o volume-select.txt</div><div class="line"></div><div class="line"><span class="preprocessor"># For text output, select paths ENDING with &#39;what&#39;, &#39;where&#39;, or &#39;how&#39;. </span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select <span class="stringliteral">&#39;what|where|how&#39;</span> -o volume-select.txt</div><div class="line"></div><div class="line"><span class="preprocessor"># For text output, select &#39;where&#39; groups of 3 lowest elevations from 0.5 degrees upwards </span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select where,elangle=0.5,count=3 -o volume-select.txt</div><div class="line"></div><div class="line"><span class="preprocessor"># For text output, select paths of elevations up to 6.0 degrees </span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select elangle=:6.0 -o volume-select.txt</div><div class="line"></div><div class="line"><span class="preprocessor"># For text output, select what and where groups of elevations from 0.5 to 5.0 degrees</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select <span class="stringliteral">&#39;what|where,elangle=0.5:7&#39;</span> -o volume-select.txt</div><div class="line"></div><div class="line"><span class="preprocessor"># For single-image output, select DBZH  </span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select elangle=1.5,quantity=DBZH -o volume-DBZH.png</div><div class="line"></div><div class="line"><span class="preprocessor"># For a Pseudo CAPPI product, change default input selection</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --select <span class="stringliteral">&#39;quantity=^TH$,elangle=1.5:10,count=3&#39;</span> --pCappi 1500 -o pCappi-TH-1500m.h5</div><div class="line"></div></div><!-- fragment --><p> Note that character escaping is needed for '|' on command line.</p>
<p>Often, the first data array matching the criteria are used.</p>
<p>One can explicitly change the criteria with <code>&ndash;select</code> (<code>-s</code>) command . For example, in data conversions one may wish to focus on certain quantity &ndash; like <code>DBZH</code> or <code>VRAD</code> &ndash; not all the data.</p>
<p>The selection command can be applied the most commands processing data. In computing meteorological products (<a class="el" href="index.html#products">Product generation</a>) an compositing, it affects the following product only. In case of anomaly detectors (<a class="el" href="andrepage.html">Anomaly Detection and Removal (AnDRe)</a>), it applies to all subsequent operators.</p>
<p>Note that some processing commands may not support explicit data selection.</p>
<h3><a class="anchor" id="selectquantity"></a>
Selecting by quantity only</h3>
<p>Selecting quantities only is frequently needed, so there is a dedicated command <code>&ndash;selectQuantity</code> (<code>-Q</code> ) which accepts comma-separated simple patterns (with * and ?) instead of regular expressions. For example, <code>-Q</code> <code>DBZH*</code>,QIND is equal to <code>&ndash;select</code> <code>quantity='^</code>(DBZH.*|QIND)$' .</p>
<div class="image">
<img src="ppi-RHOHV-panel.png" alt="ppi-RHOHV-panel.png"/>
<div class="caption">
Data selected with -Q RHOHV and coloured with <code>--palette</code>.</div></div>
 <h1><a class="anchor" id="modifying"></a>
Modifying data</h1>
<h2><a class="anchor" id="changing"></a>
Changing attribute values</h2>
<p>Attributes in an h5 structure can be changed with <code>&ndash;setODIM</code> command.</p>
<p>Modifies metadata (data attributes). </p><div class="fragment"></div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">assignment</td><td>- source path consisting of group path, attribute key and value</td></tr>
  </table>
  </dd>
</dl>
<p>A full path consist of a slash-separated group path elements followed by an attribute key separated by colon.</p>
<p>Examples: </p><div class="fragment"><div class="line"><span class="preprocessor"># Set beam resolution</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --/dataset1/where:rscale=500 -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Set date and time (note string format)</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --/what:date=<span class="stringliteral">&quot;20140827&quot;</span> --/what:time=<span class="stringliteral">&quot;093000&quot;</span> -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Set freezing level</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --/how:freeze=2.10 -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Set radar location</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --/where:lat=64.7749 --/where:lon=26.3189 -o volume-modified.h5</div><div class="line"></div></div><!-- fragment --><h2><a class="anchor" id="deleting"></a>
Deleting data</h2>
<p>The h5 structure can be pruned with <code>&ndash;delete</code> command which uses selector arguments similar to that of <code>&ndash;select</code> (see <a class="el" href="index.html#selecting">Selecting data</a>).</p>
<p>Examples: </p><div class="fragment"><div class="line"><span class="preprocessor"># Delete dataset[i] groups 2...10 </span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --<span class="keyword">delete</span> dataset2:10 -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Delete data[i] groups 3...20</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --<span class="keyword">delete</span> data3:20 -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Delete data[i] groups 3...20, in dataset[i] groups 2...10</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --<span class="keyword">delete</span> dataset2:10/data3:20 -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Delete independently dataset[i] and data[i] groups with two commands</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --<span class="keyword">delete</span> dataset2:6 --<span class="keyword">delete</span> data2:5 -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Delete data[i] groups containing VRAD</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --<span class="keyword">delete</span> quantity=VRAD -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Delete data[i] groups containing VRAD in 1.0 degree sweeps and above</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --<span class="keyword">delete</span> elangle=1.0:90,quantity=VRAD -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Delete actual data arrays</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --<span class="keyword">delete</span> data -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Delete quality[i] groups </span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --<span class="keyword">delete</span> quality: -o volume-modified.h5</div><div class="line"></div></div><!-- fragment --><p>Notice that <code>&ndash;elangle</code> applies to volume data only, and essentially selects <code>dataset</code> groups. Similarly, <code>quantity</code> selects <code>data</code> (and <code>quality</code>) groups. If selection parameters of both levels are issued in the same command, implicit <code>AND</code> function applies in selection.</p>
<h2><a class="anchor" id="keeping"></a>
Keeping some, deleting other</h2>
<p>Alternatively, one may use the complement operation <code>&ndash;keep</code> to save part of the data.</p>
<p>Metadata groups (<code>what</code>, <code>where</code>, <code>how</code>) are preserved or deleted together with their parent groups.</p>
<p>Examples: </p><div class="fragment"><div class="line"><span class="preprocessor"># Keep data[i] groups containg DBZH</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --keep quantity=DBZH -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Keep dataset[i] groups containing (at least) VRAD</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --keep quantity=VRAD -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Keep dataset[i] group with elangle 5.0 degrees, at lowest</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --keep elangle=5.0:90.0 -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Keep three dataset[i] groups with lowest elangle </span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --keep elangle=-90.0:90.0,count=3 -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Keep quality groups only</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --keep quality -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Keep quality1 and quality2 groups</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --keep quality1:2 -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Keep data specific quality groups</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --keep data:/quality -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Keep dataset[] specific quality groups</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --keep dataset:/quality -o volume-modified.h5</div><div class="line"></div></div><!-- fragment --><h2><a class="anchor" id="renaming"></a>
Renaming and moving paths and attributes</h2>
<p>One can rename existing paths (hdf5 group names) and attributes with <code>&ndash;move</code> command.</p>
<p>Rename or move data groups and attributes. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>- source path consisting at least of the group path </td></tr>
    <tr><td class="paramname">dst</td><td>- full destination path or only ':' followed by attribute key</td></tr>
  </table>
  </dd>
</dl>
<p>A full path consist of a slash-separated group path elements followed by an attribute key separated by colon. For example: <code>/dataset1/data2/what</code>:gain .</p>
<p>Examples: </p><div class="fragment"><div class="line"><span class="preprocessor"># Move group</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --move dataset1/quality1,dataset1/data1/quality3 -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Rename only the attribute key</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --move dataset1/how:task,:newtask -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Move attribute in hierarchy</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --move dataset1/how:task,what -o volume-modified.h5</div><div class="line"></div><div class="line"><span class="preprocessor"># Move and rename attribute</span></div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --move dataset1/where:nrays,dataset1/how:imageheight -o volume-modified.h5</div><div class="line"></div></div><!-- fragment --><h2><a class="anchor" id="conversions"></a>
Data conversions</h2>
<p>Volume data can be converted to desired scale and encoding with <code>&ndash;encoding</code> followed by <code>&ndash;convert</code> . If the input file contains several quantities, the target quantity can be selected with <code>&ndash;select</code> (<code>-s</code>) command:</p>
<div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume-<span class="keywordtype">double</span>.h5 -Q DBZH --encoding C,0.5,-32 --convert  -o volume-<span class="keyword">new</span>.h5</div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume-uint16.h5 -Q DBZH --encoding d --convert -Q VRAD --encoding C,0.025,-7.65506,0,255 --convert -o volume-<span class="keyword">new</span>.h5</div></div><!-- fragment --><h2><a class="anchor" id="target"></a>
Defining target data properties</h2>
<p>The desired output storage type, scaling, and encoding can be set with <code>&ndash;encoding</code> command. Depending on the following command, a varying set of properties will be supported. The general form of <code>&ndash;encoding</code> command is </p><div class="fragment"><div class="line">rack &lt;input&gt;  --encoding &lt;type&gt;,&lt;gain&gt;,&lt;offset&gt;,&lt;undetect&gt;,&lt;nodata&gt;,&lt;rscale&gt;,&lt;nrays&gt;,&lt;nbins&gt;  &lt;commands&gt;</div></div><!-- fragment --><p> One may set one or more properties by giving only N first ones. Also <code>key=value</code> forms are supported. The typical choices for storage type are 'C' (unsigned char), 'S' (unsigned short int) and 'd' (double precision float). The next parameters <code>gain</code> and <code>offset</code> define the mapping between bit values and the physical quantity: <em>f</em> = <code>gain</code> * <em>x</em> + <code>offset</code> . In ODIM standard, <code>undetect</code> marks the data where a measurement value falls under a sensitivity limit and <code>nodata</code> marks areas where no measurement at all is available. Also grid geometry (<code>nbins</code> , <code>nrays</code> and <code>rscale</code> ) can be set when applicable. For example, producing a polar product (here 500m CAPPI, see <a class="el" href="productspage.html">Meteorological products</a>) with some desired properties is given by: </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --encoding C,0.4,-20,rscale=1000,nbins=250  --pCappi 500 -o cappi-500.h5</div></div><!-- fragment --><p> <b>Rack</b> provides default encodings for some quantities. The configuration can be listed and changed with <code>&ndash;quantityConf</code> command.</p>
<p>As to hierarchical structure of resulting products, the default location of computed meteorological products and Composites is <code>/dataset1/data1</code> . Any previous results are overwritten. This can be changed by means of <code>&ndash;append</code> command: one can combine several products in same <code>dataset</code> group, adding a new <code>data</code> group, or append a new <code>dataset</code> group.</p>
<h2><a class="anchor" id="validator"></a>
Validating data structure</h2>
<p><b>Rack</b> supports validating both input data and products it generates. The process uses comma-separated definition files by OPERA, originally designed by Ladislav Meri (SMU). Input data is validated by issuing <code>&ndash;validate</code> command after reading the data: </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --validate ODIM_H5_V2_2_PVOL.csv </div></div><!-- fragment --><p> Output data &ndash; polar or Cartesian products &ndash; can be validated similarly, after generating the products: </p><div class="fragment"><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 --pCappi 500      --validate ODIM_H5_V2_3_PPROD.csv </div><div class="line"><a class="code" href="namespacerack.html">rack</a> volume.h5 -Q DBZH --cCreate --validate ODIM_H5_V2_3_CART.csv </div></div><!-- fragment --><p> Normal warnings and notifications are displayed upon exceptions. More verbose output obtained with <code>&ndash;verbose</code> <code>7</code> , for example. In future versions, automatic validator filename selection may be supported (based on attribute <code>what:version</code> ). Note: only some basic defition files have been designed by <code>OPERA</code> this far. Note2: <b>Rack</b> is mostly, but not fully, compliant to <code>ODIM</code> <code>2.2</code> and <code>2.3</code> .</p>
<dl class="section author"><dt>Author</dt><dd>Markus Peura, Seppo Pulkkinen (HDF5 support), Joonas Karjalainen </dd></dl>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
